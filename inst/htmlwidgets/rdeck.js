!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.rdeck=t():e.rdeck=t()}(self,(function(){return(()=>{var e,t={6153:(e,t,r)=>{"use strict";r.r(t),r.d(t,{VERSION:()=>ut,Widget:()=>st,binding:()=>at,getWidgetById:()=>lt,getWidgets:()=>ct});var n={};r.r(n),r.d(n,{AGGREGATION_OPERATION:()=>c.KM,ArcLayer:()=>l.zv,BitmapLayer:()=>l.hz,CPUGridLayer:()=>c.ab,ColumnLayer:()=>l.eJ,ContourLayer:()=>c.YY,GPUGridLayer:()=>c.ML,GeoJsonLayer:()=>l.UW,GreatCircleLayer:()=>u.GJ,GridCellLayer:()=>l.cJ,GridLayer:()=>c.mU,H3ClusterLayer:()=>u.cH,H3HexagonLayer:()=>u.bW,HeatmapLayer:()=>c.zP,HexagonLayer:()=>c.dX,IconLayer:()=>l.eE,LineLayer:()=>l.Ie,MVTLayer:()=>u.i3,PathLayer:()=>l.nr,PointCloudLayer:()=>l.U5,PolygonLayer:()=>l.dW,S2Layer:()=>u.jJ,ScatterplotLayer:()=>l.pU,ScenegraphLayer:()=>d.S,ScreenGridLayer:()=>c.p3,SimpleMeshLayer:()=>d.L,SolidPolygonLayer:()=>l.PJ,TerrainLayer:()=>u.tr,TextLayer:()=>l.AB,Tile3DLayer:()=>u.cY,TileLayer:()=>u.Im,TripsLayer:()=>u.Fw,_AggregationLayer:()=>c.Di,_BinSorter:()=>c.l0,_CPUAggregator:()=>c.oA,_GPUGridAggregator:()=>c.Wc,_MultiIconLayer:()=>l.vb,_TextBackgroundLayer:()=>l._k});r(8559);var i=r(5893),o=r(3935),a=r(7294),s=r(3286),l=r(7786),c=r(9080),u=r(9534),d=r(1956),p=r(5395);const h=[0,0,0,255];function f([e,t,r,n=255]){return`rgba(${e}, ${t}, ${r}, ${n/255})`}function m(e,t){return Array.isArray(e)?t||4!==e.length?((t=null!=t?t:[])[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=3===e.length?e[3]:255,t):e:"string"==typeof e?(function(e,t){if(7===e.length){const r=parseInt(e.substring(1),16);t[0]=Math.floor(r/65536),t[1]=Math.floor(r/256%256),t[2]=r%256,t[3]=255}else if(9===e.length){const r=parseInt(e.substring(1),16);t[0]=Math.floor(r/16777216),t[1]=Math.floor(r/65536%256),t[2]=Math.floor(r/256%256),t[3]=r%256}}(e,t=null!=t?t:[]),t):h}var y=r(4634),v=r(4177),g=r(458),b=r(602),j=r(8973),x=r(2625);function w(e){return null!==e&&"object"==typeof e&&"accessor"===e.type}function L(e,t){const r=function({col:e,dataType:t},r){if("highlightColor"===r)switch(t){case"table":return function(e){return({index:t,layer:r})=>m(r.props.data.frame[e][t])}(e);case"object":return function(e){return({object:t})=>m(t[e])}(e);case"geojson":return function(e){return({object:t})=>m(t.properties[e])}(e);default:throw TypeError(`${t} not supported`)}if(r.endsWith("Color"))switch(t){case"table":return function(e){return(t,{index:r,data:n,target:i})=>m(n.frame[e][r],i)}(e);case"object":return function(e){return(t,{target:r})=>m(t[e],r)}(e);case"geojson":return function(e){return(t,{target:r})=>m(t.properties[e],r)}(e);default:throw TypeError(`${t} not supported`)}switch(t){case"table":return function(e){return(t,{index:r,data:n})=>n.frame[e][r]}(e);case"object":return function(e){return t=>t[e]}(e);case"geojson":return function(e){return t=>t.properties[e]}(e);default:throw TypeError(`${t} not supported`)}}(e,t);return{...e,getData:r}}function N(e){return w(e)&&"scale"in e}function k(e,t){"palette"in e&&(e.range=e.palette.map((e=>m(e))),e.unknown=m(e.unknown));const r=function(e){switch(e.scale){case"linear":return(0,y.Z)().domain(e.domain).range(e.range).unknown(e.unknown).clamp(!0);case"power":return(0,v.ZP)().exponent(e.exponent).domain(e.domain).range(e.range).unknown(e.unknown).clamp(!0);case"log":return(0,g.Z)().base(e.base).domain(e.domain).range(e.range).unknown(e.unknown).clamp(!0);case"threshold":case"quantile":return(0,b.Z)().domain(e.domain).range(e.range).unknown(e.unknown);case"category":return(0,j.Z)().domain(e.domain).range(e.range).unknown(e.unknown);case"quantize":return(0,x.Z)().domain(e.domain).range(e.range).unknown(e.unknown);default:throw TypeError(`scale ${e.scale} not supported`)}}(e),n="highlightColor"===t?function({col:e,dataType:t},r){switch(t){case"table":return function(e,t){return({index:r,layer:n})=>{var i;return t(null!==(i=n.props.data.frame[e][r])&&void 0!==i?i:void 0)}}(e,r);case"object":return function(e,t){return({object:r})=>{var n;return t(null!==(n=r[e])&&void 0!==n?n:void 0)}}(e,r);case"geojson":return function(e,t){return({object:r})=>{var n;return t(null!==(n=r.properties[e])&&void 0!==n?n:void 0)}}(e,r);default:throw TypeError(`${t} not supported`)}}(e,r):function({col:e,dataType:t},r){switch(t){case"table":return function(e,t){return(r,{index:n,data:i})=>{var o;return t(null!==(o=i.frame[e][n])&&void 0!==o?o:void 0)}}(e,r);case"object":return function(e,t){return r=>{var n;return t(null!==(n=r[e])&&void 0!==n?n:void 0)}}(e,r);case"geojson":return function(e,t){return r=>{var n;return t(null!==(n=r.properties[e])&&void 0!==n?n:void 0)}}(e,r);default:throw TypeError(`${t} not supported`)}}(e,r);return{...e,name:t,getData:n,scaleData:r}}var A=r(9757);function C(e="normal"){switch(e){case"additive":return{[A.Z.BLEND]:!0,blendFunc:[A.Z.SRC_ALPHA,A.Z.DST_ALPHA],blendEquation:A.Z.FUNC_ADD};case"subtractive":return{[A.Z.BLEND]:!0,blendFunc:[A.Z.ONE,A.Z.ONE_MINUS_DST_COLOR,A.Z.SRC_ALPHA,A.Z.DST_ALPHA],blendEquation:[A.Z.FUNC_SUBTRACT,A.Z.FUNC_ADD]};default:return{[A.Z.BLEND]:!0,blendFunc:[A.Z.SRC_ALPHA,A.Z.ONE_MINUS_SRC_ALPHA,A.Z.ONE,A.Z.ONE_MINUS_SRC_ALPHA],blendEquation:[A.Z.FUNC_ADD,A.Z.FUNC_ADD]}}}function S(e){return null!==e&&"object"==typeof e&&"frame"in e}function T(e){const t=function(e){return Object.entries(e.geometry).filter((([,e])=>/MULTI/.test(e))).map((([e,t])=>({name:e,type:t})))}(e);return 0===t.length?e:t.reduce(_,e)}function _(e,{name:t,type:r}){var n,i,o,a;const s=e.frame,l=Object.fromEntries(Object.entries(s).map((([e])=>[e,[]]))),c=Object.keys(e.frame).filter((e=>e!==t)),u=s[t],d=function(e){switch(e){case"MULTIPOINT":return E;case"MULTILINESTRING":return Z;case"MULTIPOLYGON":return O;default:throw TypeError(`${e} not supported`)}}(r),p=e=>{for(const t of c)l[t].push(s[t][e])},h=[];for(let r=0;r<e.length;r++){const s=u[r];if(d(s)){l[t].push(...s);for(let t=0;t<s.length;t++)p(r),h.push(null!==(i=null===(n=e.indices)||void 0===n?void 0:n[r])&&void 0!==i?i:r)}else l[t].push(s),p(r),h.push(null!==(a=null===(o=e.indices)||void 0===o?void 0:o[r])&&void 0!==a?a:r)}return{length:l[t].length,geometry:{...e.geometry,[t]:r.replace("MULTI","")},indices:h,frame:l}}function E(e){return Array.isArray(null==e?void 0:e[0])}function Z(e){var t;return Array.isArray(null===(t=null==e?void 0:e[0])||void 0===t?void 0:t[0])}function O(e){var t,r;return Array.isArray(null===(r=null===(t=null==e?void 0:e[0])||void 0===t?void 0:t[0])||void 0===r?void 0:r[0])}var M=r(3693),P=r(4717),D=r(6867),H=r(3326),I=r(2112),G=r(7693),R=r(8569),U=r(1435);class z extends M.Z{initializeState(){if(!function(e){return F.some((t=>e instanceof t))}(this))return;const e=this,t=e.getAttributeManager();t&&t.addInstanced({pickingColors:{type:A.Z.UNSIGNED_BYTE,size:3,accessor:(t,{index:r,data:n,target:i})=>{var o,a,s;if(S(n)&&Array.isArray(n.indices))return e.encodePickingColor(n.indices.indexOf(n.indices[r]),i);const l=null===(a=null===(o=null==t?void 0:t.__source)||void 0===o?void 0:o.parent)||void 0===a?void 0:a.props.data;return S(l)&&Array.isArray(l.indices)?e.encodePickingColor(l.indices.indexOf(l.indices[t.__source.index]),i):e.encodePickingColor(null!==(s=null==t?void 0:t.__source.index)&&void 0!==s?s:r,i)},shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}}const F=[P.Z,D.Z,H.Z,I.Z,G.Z,R.Z,U.Z];class W{constructor({type:e,...t}){var r,n;const i=Object.entries(t),o=function(e){const t=e.filter(q).map((([e,t])=>[e,m(t)])),r=e.find((([e])=>"colorRange"===e));r&&t.push([r[0],r[1].map((e=>m(e)))]);return t}(i),a=function(e){return e.filter((([,e])=>w(e))).map((([e,t])=>[e,N(t)?k(t,e):L(t,e)]))}(i);this.type=e;const s=Object.fromEntries([...i,...o,...a.map((([e,t])=>[e,t.getData])),...Y(i),["visible",null===(r=t.visible)||void 0===r||r],["updateTriggers",V(a)],["parameters",(l=t.parameters,c=t.blendingMode,{...l,...C(c)})]]);var l,c;S(s.data)&&(s.data=T(s.data),s.extensions=[new z,...null!==(n=s.extensions)&&void 0!==n?n:[]]),"TileLayer"===e&&(s.renderSubLayers=e=>{const{bbox:{west:t,south:r,east:n,north:i},x:o,y:a,z:s}=e.tile;return new p.Z({...e,data:[{z:s,x:o,y:a}],image:e.data,bounds:[t,r,n,i]})}),this.props=s,this.scales=a.filter((([,e])=>N(e))).map((([,e])=>e)),"TextLayer"===e&&"fonts"in document&&document.fonts.load(`16px ${t.fontFamily}`)}static create(e){return new W(e)}renderLayer(e){if("TripsLayer"===this.type&&void 0!==e){const t=this.props,{loopLength:r,animationSpeed:n}=t,i=r/n,o=e/1e3%i/i;t.currentTime=o*r}return new n[this.type]({...this.props})}renderLegend(){const e=this.scales.filter((e=>e.legend));return{id:this.props.id,name:this.props.name,scales:e}}renderSelector(){var e;return{id:this.props.id,groupName:this.props.groupName,name:this.props.name,visible:null===(e=this.props.visible)||void 0===e||e}}}function q([e,t]){return e.endsWith("Color")&&(Array.isArray(t)||"string"==typeof t)}function V(e){const t=e=>{const{getData:t,scaleData:r,palette:n,...i}=e;return i},r=e.map((([e,r])=>[e,t(r)]));return Object.fromEntries(r)}function Y(e){return e.filter((([e])=>"getColorWeight"===e||"getElevationWeight"===e)).filter((([,e])=>null!==e&&"function"!=typeof e&&!w(e))).map((([e,t])=>[e,()=>t]))}r(6158);var B=r(937),$=r(9106);const J="cyWLt4_G7nk5vT9hPr0o",K="Z9hHHet2RXmL0iMel3Zt",X="jp658yEHLlesSRvwBwDl",Q="t9I8kJyjeEJEOArvMD7j",ee="vovHpTur01BROrMLmEFz";function te({info:e}){if(null==e)return null;const{index:t,layer:r,x:n,y:o}=e,{name:a,tooltip:s}=r.props,l=function(e){switch(e){case"table":return(e,{index:t,data:r})=>{const n=Object.entries(r.frame).map((([e,r])=>[e,r[t]]));return Object.fromEntries(n)};case"object":return e=>null!=e?e:{};case"geojson":return e=>{var t;return null!==(t=null==e?void 0:e.properties)&&void 0!==t?t:{}};default:throw TypeError(`${e} not supported`)}}(s.dataType),c=l(e.object,{index:t,data:r.props.data}),u=!0===s.cols?Object.keys(c):s.cols;return(0,i.jsxs)("div",{className:J,style:{transform:`translate(${n}px, ${o}px)`},children:[(0,i.jsx)("div",{className:K,children:a},void 0),(0,i.jsx)("table",{className:X,children:(0,i.jsx)("tbody",{children:u.map((e=>{var t;return(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{className:Q,children:e},void 0),(0,i.jsx)("td",{className:ee,children:String(null!==(t=c[e])&&void 0!==t?t:null)},void 0)]},e)}))},void 0)},void 0)]},void 0)}var re=r(3295);function ne({props:e,layers:t}){const r=(0,a.useRef)(null),[n,o]=ie(),{mapboxApiAccessToken:l,mapStyle:c,mapOptions:u,controller:d,parameters:p,blendingMode:h,...f}=e,m={...p,...C(h)},[y,v]=(0,a.useState)(0),g=0!==t.filter((e=>"TripsLayer"===e.type)).length;oe(g,(e=>v(e)));const b=t.filter((e=>null!=e.type)).map((e=>e.renderLayer(y)));return(0,i.jsxs)(a.Fragment,{children:[(0,i.jsx)($.Z,{ref:r,...f,parameters:m,layers:b,onHover:o,children:(0,i.jsx)(B.Z,{id:"map",controller:d,repeat:!0,children:c&&(0,i.jsx)(s.Z3,{reuseMaps:!0,mapboxApiAccessToken:l,mapStyle:c,mapOptions:u},void 0)},void 0)},void 0),(0,i.jsx)(te,{info:n},void 0)]},void 0)}const ie=()=>{const[e,t]=(0,a.useState)(null);return[e,(0,a.useCallback)((e=>{if(!e.picked||!e.layer.props.tooltip||e.layer instanceof re.Z)return t(null);t(e)}),[])]},oe=(e,t)=>{const r=(0,a.useRef)(0),n=(0,a.useRef)(Date.now()),i=()=>{t(Date.now()-n.current),r.current=window.requestAnimationFrame(i)};(0,a.useEffect)((()=>{if(e)return r.current=window.requestAnimationFrame(i),()=>window.cancelAnimationFrame(r.current)}),[e])};function ae(e){return e.clientHeight>0&&e.clientHeight>0?e:e.parentElement?ae(e.parentElement):null}function se(e){const t=ae(e);if(e===t||null==t)return[e.clientWidth,e.clientHeight];const{width:r,height:n}=getComputedStyle(e),i=document.createElement("div");Object.assign(i.style,{width:r,height:n,display:"hidden"}),t.appendChild(i);const o=[i.clientWidth,i.clientHeight];return t.removeChild(i),o}function le(e,t){const r=new Map;for(const n of e){const e=t(n);r.has(e)?r.get(e).push(n):r.set(e,[n])}return r}function ce(...e){return e.filter((e=>null!=e)).join(" ")}const ue="dePkhbnJCOHYUAj_NSXj",de="UswwkaMDoib4ytc60Zn9",pe="ci5EIFzH7r10AG6BsqiG",he="tc2iXBk_fR6q5GWWpo9m",fe="RYWzL7KGDYHIY2NHbF5X",me="rn68pqskorQGGcY_sqUg",ye="nYpzg_48IyHFet4DMSbT",ve="hrbqGf9YJYCqN3_tMI1L",ge="Nq2XC5CmWGG2PSgH92Tr",be="njcitPfCPlr7ohpeig92",je=16;function xe({layers:e}){return 0===e.length?null:(0,i.jsx)("div",{className:ue,children:e.map((e=>(0,i.jsx)(we,{...e},e.id)))},void 0)}function we({name:e,scales:t}){return 0===t.length?null:(0,i.jsxs)("div",{className:de,children:[(0,i.jsx)("div",{className:pe,title:e,children:e},void 0),t.map((e=>(0,i.jsx)(Le,{...e},e.name)))]},void 0)}function Le(e){const t=e.name.replace(/^get/,"").replace(/([A-Z])/g," $1").toLowerCase();const r="palette"in e;const n=function(e){return"linear"===e.scale||"power"===e.scale||"log"===e.scale}(e),o=function(e){return"threshold"===e.scale||"quantile"===e.scale||"quantize"===e.scale}(e);return(0,i.jsxs)("div",{className:he,children:[(0,i.jsx)("div",{className:fe,children:t},void 0),(0,i.jsx)("span",{className:me,children:"by "},void 0),(0,i.jsx)("span",{className:ye,title:e.col,children:e.col},void 0),r&&n&&(0,i.jsx)(Ne,{...e},void 0),r&&o&&(0,i.jsx)(ke,{...e},void 0),r&&"category"===e.scale&&(0,i.jsx)(Ae,{...e},void 0)]},void 0)}const Ne=({ticks:e,scaleData:t})=>{const r=e.map(((e,t)=>t)).slice(1,-1),n=je*(e.length-1),o=n+11+1;return(0,i.jsxs)("svg",{className:ve,height:o,shapeRendering:"crispEdges",children:[(0,i.jsxs)("svg",{y:5,children:[(0,i.jsx)("image",{width:20,height:n,href:Se(t),preserveAspectRatio:"none"},void 0),r.map((e=>(0,i.jsx)("line",{className:be,x2:20,y1:je*e,y2:je*e},e)))]},void 0),(0,i.jsx)(Ce,{ticks:e,y:-2},void 0)]},void 0)},ke=({ticks:e,range:t})=>{const r=t.map(f),n=je*(e.length-1)+11+1;return(0,i.jsxs)("svg",{className:ve,height:n,shapeRendering:"crispEdges",children:[(0,i.jsx)("svg",{y:5,children:r.map(((e,t)=>(0,i.jsx)("rect",{width:20,height:je,y:t*je,fill:e},t)))},void 0),(0,i.jsx)(Ce,{ticks:e,y:-2},void 0)]},void 0)};function Ae({ticks:e,range:t,unknownTick:r,unknown:n}){const o=r?[...t,n]:t,a=r?[...e,r]:e,s=o.map(f),l=je*a.length;return(0,i.jsxs)("svg",{className:ve,height:l,children:[(0,i.jsx)("svg",{children:s.map(((e,t)=>(0,i.jsx)("rect",{width:20,height:14,y:1+t*je,fill:e},t)))},void 0),(0,i.jsx)(Ce,{ticks:a},void 0)]},void 0)}function Ce({ticks:e,x:t=28,y:r=0}){return(0,i.jsx)("svg",{x:t,y:r,children:e.map(((e,t)=>(0,i.jsx)("text",{className:ge,y:je*t,dy:11,children:String(e)},t)))},void 0)}function Se(e,t=200){const r=e.range().length,n=[...Array(r).keys()].map((e=>e/(r-1))),i=e.copy().range(n).invert,o=document.createElement("canvas"),a=o.getContext("2d");o.width=1,o.height=t;for(let r=0;r<t;r++)a.fillStyle=f(e(i(r/t))),a.fillRect(0,r,1,1);return o.toDataURL()}const Te="rdeck",_e="S9CJIVXVAK0I3CutdI6g",Ee="YdjmCX6zK6bSK2hf1f10",Ze="UVOq5gxQhkpq8sCqRgI2";var Oe=r(148),Me=r(9816),Pe=r(9826),De=r(6218);const He="vuAOyD_5tWmY2RPHTuYY",Ie="n6jppVxEBKOj1hSBYZ6_",Ge="KQfHmYbZf5cmK9e6t3iK",Re="LZXYw_iUEePVNUQgV40h",Ue="DbzmP4_hJ6wY628cSZhG",ze="xKDjjRbJSZxg0xyD0nAI",Fe="vLGippSuMIytgXuofCKd",We="fG18f7ZGepQ_2FcTrPlj",qe="mHkJXAoHRaJi5uTJ1HgN",Ve="yEmldpPm5pY_q_QOaYBM",Ye="s4NzyM8HmUyOUjhwFGTG",Be=Date.now();function $e({className:e,tooltip:t,onClick:r,children:n}){return(0,i.jsx)("button",{className:e,type:"button",onClick:r,title:t,children:n},void 0)}function Je({layers:e,onVisibilityChange:t}){const r=le(e,(e=>{var t;return null!==(t=e.groupName)&&void 0!==t?t:`${e.name}-${Be}`})),n=(r,n,i)=>{if(i){const i=!e.filter((e=>!r.includes(e))).some((e=>e.visible));return t(e.map((e=>({...e,visible:r.includes(e)?n:i}))))}t(r.map((e=>({...e,visible:n}))))},[o,s]=(0,a.useState)(!1),l=()=>s((e=>!e));return o?(0,i.jsxs)("div",{className:Ie,children:[(0,i.jsx)("div",{className:Ge,children:(0,i.jsxs)($e,{className:Re,onClick:l,tooltip:"Close",children:[(0,i.jsx)(Oe.Z,{className:Ye,fontSize:"small"},void 0),(0,i.jsx)("span",{className:Ue,children:"Layers"},void 0)]},void 0)},void 0),(0,i.jsx)("div",{className:ze,children:Array.from(r.entries(),(([e,t,[{groupName:r}]=t])=>(0,i.jsx)(Ke,{group:r,layers:t,onChange:n},e)))},void 0)]},void 0):(0,i.jsx)($e,{className:He,tooltip:"Layer selector",onClick:l,children:(0,i.jsx)(Oe.Z,{className:Ye,fontSize:"small"},void 0)},void 0)}function Ke({group:e,layers:t,onChange:r}){const n=Array.from(le(t,(e=>e.name)),(([e,t])=>(0,i.jsx)(Xe,{name:e,layers:t,onChange:r},e)));return e?(0,i.jsxs)(a.Fragment,{children:[(0,i.jsx)(Xe,{name:e,layers:t,onChange:r},void 0),(0,i.jsx)("div",{className:Fe,children:n},void 0)]},void 0):(0,i.jsx)(a.Fragment,{children:n},void 0)}function Xe({name:e,layers:t,onChange:r}){const n=function(e){let t=e[0].visible;for(const r of e)if(r.visible!==t)return null;return t}(t),o=null===n,s=(0,a.useRef)(null);(0,a.useEffect)((()=>{s.current&&(s.current.indeterminate=o)}),[o]);const l=(0,a.useRef)((()=>!1)),c=n?Me.Z:o?Pe.Z:De.Z,u=ce(We,n||o?qe:null);return(0,i.jsxs)("label",{className:u,children:[(0,i.jsx)("input",{ref:s,className:Ve,type:"checkbox",onChange:()=>{l.current()?r(t,!0,!0):l.current=Qe((()=>r(t,!n,!1)),200)},checked:null==n||n},void 0),(0,i.jsx)(c,{fontSize:"small",className:Ye},void 0),(0,i.jsx)("span",{className:Ue,children:e},void 0)]},void 0)}const Qe=(e,t=200)=>{const r={current:0};let n=0;const i=o=>{if(n||(n=o),o-n>t)return r.current=0,void e();r.current=globalThis.requestAnimationFrame(i)};return r.current=globalThis.requestAnimationFrame(i),()=>0!==r.current&&(globalThis.cancelAnimationFrame(r.current),r.current=0,!0)};function et({props:e,layers:t,theme:r,lazyLoad:n,layerSelector:o,onLayerVisibilityChange:l,width:c,height:u}){const{initialBounds:d,initialViewState:p,...h}=e,f=function(e,t,r,n){return(0,a.useMemo)((()=>{if(!Array.isArray(r))return n;const[i,o,a,l]=r,c=[[Math.max(-180,i),Math.max(o,-85.051129)],[Math.min(180,a),Math.min(l,85.051129)]],u=new s.DW({width:e,height:t}),{longitude:d,latitude:p,zoom:h}=u.fitBounds(c);return{...n,longitude:d,latitude:p,zoom:h}}),[r,n,e,t])}(c,u,d,p),m=t.map(W.create),y=(0,a.useRef)(null),v=function(e,t){const[r,n]=(0,a.useState)(!1);return(0,a.useEffect)((()=>{if(t&&e.current){const t=new IntersectionObserver((e=>{n(e[0].isIntersecting)}),{threshold:0});return t.observe(e.current),()=>t.disconnect()}}),[t,e]),r}(y,n),g=!n||v;return(0,i.jsxs)("div",{ref:y,className:ce(Te,r),children:[(0,i.jsx)("div",{className:ce(_e,Ee),children:o&&(0,i.jsx)(Je,{layers:m.filter((e=>e.props.visibilityToggle)).map((e=>e.renderSelector())).reverse(),onVisibilityChange:l},void 0)},void 0),g&&(0,i.jsx)(ne,{props:{...h,initialViewState:f},layers:m},void 0),(0,i.jsx)("div",{className:ce(_e,Ze),children:(0,i.jsx)(xe,{layers:m.filter((e=>e.props.visible)).map((e=>e.renderLegend())).reverse()},void 0)},void 0)]},void 0)}var tt,rt,nt,it=function(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r},ot=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};const at={name:"rdeck",type:"output",factory:(e,t,r)=>(0!==t&&0!==r||([t,r]=se(e)),new st(e,t,r))};class st{constructor(e,t,r){tt.set(this,void 0),rt.set(this,void 0),nt.set(this,void 0),this.props={blendingMode:"normal"},this.layers=[],this.theme="kepler",this.layerSelector=!0,this.lazyLoad=!1,it(this,tt,e,"f"),it(this,rt,t,"f"),it(this,nt,r,"f"),HTMLWidgets.shinyMode&&(Shiny.addCustomMessageHandler(`${e.id}:layer`,(e=>{var t,r;const n=this.layers.find((t=>t.id===e.id));if(!n)return this.renderValue({layers:[...this.layers,e]});const i=null!==(t=e.visible)&&void 0!==t?t:n.visible,o=null!==(r=e.data)&&void 0!==r?r:n.data,a={...n,...e,visible:i,data:o},s=this.layers.map((e=>e===n?a:e));this.renderValue({layers:s})})),Shiny.addCustomMessageHandler(`${e.id}:deck`,(({props:e,theme:t,lazyLoad:r})=>{this.renderValue({props:{...this.props,...e},theme:t,lazyLoad:r})}))),this.setLayerVisibility=this.setLayerVisibility.bind(this)}renderValue({props:e,layers:t,theme:r,layerSelector:n,lazyLoad:a}){const s={props:null!=e?e:this.props,layers:null!=t?t:this.layers,theme:null!=r?r:this.theme,layerSelector:null!=n?n:this.layerSelector,lazyLoad:null!=a?a:this.lazyLoad};Object.assign(this,s),o.render((0,i.jsx)(et,{...s,onLayerVisibilityChange:this.setLayerVisibility,width:ot(this,rt,"f"),height:ot(this,nt,"f")},void 0),ot(this,tt,"f"))}resize(e,t){}get id(){return ot(this,tt,"f").id}setLayerVisibility(e){if(0===e.length)return;const t=this.layers.map((t=>{const r=e.find((e=>((e,t)=>{const r=e.name===t.name,n=e.groupName===t.groupName;return r&&n||null==e.name&&null!=e.groupName&&n})(e,t)&&e.visible!==t.visible));return r?{...t,visible:r.visible}:t}));this.renderValue({layers:t})}}function lt(e){var t;const r=document.getElementById(e);return null!==(t=null==r?void 0:r.htmlwidget_data_init_result)&&void 0!==t?t:null}function ct(){return[...document.querySelectorAll(".rdeck.html-widget")].map((e=>e.htmlwidget_data_init_result)).filter((e=>e instanceof st))}tt=new WeakMap,rt=new WeakMap,nt=new WeakMap,HTMLWidgets.widget(at);const ut="0.4.0-dev"},9521:()=>{},9125:()=>{},5307:()=>{}},r={};function n(e){var i=r[e];if(void 0!==i)return i.exports;var o=r[e]={exports:{}};return t[e].call(o.exports,o,o.exports,n),o.exports}n.m=t,e=[],n.O=(t,r,i,o)=>{if(!r){var a=1/0;for(u=0;u<e.length;u++){for(var[r,i,o]=e[u],s=!0,l=0;l<r.length;l++)(!1&o||a>=o)&&Object.keys(n.O).every((e=>n.O[e](r[l])))?r.splice(l--,1):(s=!1,o<a&&(a=o));if(s){e.splice(u--,1);var c=i();void 0!==c&&(t=c)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[r,i,o]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={472:0};n.O.j=t=>0===e[t];var t=(t,r)=>{var i,o,[a,s,l]=r,c=0;if(a.some((t=>0!==e[t]))){for(i in s)n.o(s,i)&&(n.m[i]=s[i]);if(l)var u=l(n)}for(t&&t(r);c<a.length;c++)o=a[c],n.o(e,o)&&e[o]&&e[o][0](),e[a[c]]=0;return n.O(u)},r=self.webpackChunkrdeck=self.webpackChunkrdeck||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var i=n.O(void 0,[486,474,619,568,627,688,811,784,899,42,324,667,134,745,535,528,378,877,394,816,485,650,869,706,683,67,14,645,806,282,836,96,813,451,912,261,247,590,355,953,44,538,49,639,360,825,596],(()=>n(6153)));return i=n.O(i)})()}));